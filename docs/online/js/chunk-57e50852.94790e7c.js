(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57e50852"],{"0390":function(t,e,n){"use strict";var a=n("02f4")(!0);t.exports=function(t,e,n){return e+(n?a(t,e).length:1)}},"0bfb":function(t,e,n){"use strict";var a=n("cb7c");t.exports=function(){var t=a(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"214f":function(t,e,n){"use strict";n("b0c5");var a=n("2aba"),r=n("32e9"),s=n("79e5"),i=n("be13"),c=n("2b4c"),o=n("520a"),u=c("species"),l=!s((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),d=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var p=c(t),h=!s((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),b=h?!s((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[u]=function(){return n}),n[p](""),!e})):void 0;if(!h||!b||"replace"===t&&!l||"split"===t&&!d){var f=/./[p],g=n(i,p,""[t],(function(t,e,n,a,r){return e.exec===o?h&&!r?{done:!0,value:f.call(e,n,a)}:{done:!0,value:t.call(n,e,a)}:{done:!1}})),v=g[0],m=g[1];a(String.prototype,t,v),r(RegExp.prototype,p,2==e?function(t,e){return m.call(t,this,e)}:function(t){return m.call(t,this)})}}},"520a":function(t,e,n){"use strict";var a=n("0bfb"),r=RegExp.prototype.exec,s=String.prototype.replace,i=r,c="lastIndex",o=function(){var t=/a/,e=/b*/g;return r.call(t,"a"),r.call(e,"a"),0!==t[c]||0!==e[c]}(),u=void 0!==/()??/.exec("")[1],l=o||u;l&&(i=function(t){var e,n,i,l,d=this;return u&&(n=new RegExp("^"+d.source+"$(?!\\s)",a.call(d))),o&&(e=d[c]),i=r.call(d,t),o&&i&&(d[c]=d.global?i.index+i[0].length:e),u&&i&&i.length>1&&s.call(i[0],n,(function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(i[l]=void 0)})),i}),t.exports=i},"5f1b":function(t,e,n){"use strict";var a=n("23c6"),r=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var s=n.call(t,e);if("object"!==typeof s)throw new TypeError("RegExp exec method returned something other than an Object or null");return s}if("RegExp"!==a(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},a481:function(t,e,n){"use strict";var a=n("cb7c"),r=n("4bf8"),s=n("9def"),i=n("4588"),c=n("0390"),o=n("5f1b"),u=Math.max,l=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g,b=function(t){return void 0===t?t:String(t)};n("214f")("replace",2,(function(t,e,n,f){return[function(a,r){var s=t(this),i=void 0==a?void 0:a[e];return void 0!==i?i.call(a,s,r):n.call(String(s),a,r)},function(t,e){var r=f(n,t,this,e);if(r.done)return r.value;var d=a(t),p=String(this),h="function"===typeof e;h||(e=String(e));var v=d.global;if(v){var m=d.unicode;d.lastIndex=0}var S=[];while(1){var x=o(d,p);if(null===x)break;if(S.push(x),!v)break;var w=String(x[0]);""===w&&(d.lastIndex=c(p,s(d.lastIndex),m))}for(var O="",y=0,j=0;j<S.length;j++){x=S[j];for(var C=String(x[0]),_=u(l(i(x.index),p.length),0),D=[],k=1;k<x.length;k++)D.push(b(x[k]));var A=x.groups;if(h){var E=[C].concat(D,_,p);void 0!==A&&E.push(A);var $=String(e.apply(void 0,E))}else $=g(C,p,_,D,A,e);_>=y&&(O+=p.slice(y,_)+$,y=_+C.length)}return O+p.slice(y)}];function g(t,e,a,s,i,c){var o=a+t.length,u=s.length,l=h;return void 0!==i&&(i=r(i),l=p),n.call(c,l,(function(n,r){var c;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,a);case"'":return e.slice(o);case"<":c=i[r.slice(1,-1)];break;default:var l=+r;if(0===l)return n;if(l>u){var p=d(l/10);return 0===p?n:p<=u?void 0===s[p-1]?r.charAt(1):s[p-1]+r.charAt(1):n}c=s[l-1]}return void 0===c?"":c}))}}))},b0c5:function(t,e,n){"use strict";var a=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:a!==/./.exec},{exec:a})},bb51:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isLoadingDashboards?n("div",{staticClass:"user-preview"},[t._v("\n    正在获取主页数据...\n  ")]):n("div",[t.home.studentDashboard?n("div",{staticClass:"user-preview"},[n("StudentDashboard",{attrs:{dashboard:t.home.studentDashboard}})],1):n("div",[n("h1",[t._v("TODO")])])])])},r=[],s=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),i=(n("f559"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-preview"},[0===t.dashboard.classes.length?n("div",{staticClass:"user-preview"},[t._v("\n    您还没有参加任何佛学课程！\n  ")]):t._l(t.dashboard.classes,(function(t,e){return n("Class",{key:e,attrs:{buddhaClass:t}})}))],2)}),c=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",{domProps:{textContent:t._s(t.buddhaClass.name)}}),n("h4",[t._v("辅导员："+t._s(t.teachers)+" 师兄")]),n("b-button",{attrs:{block:"",variant:"info",href:t.buddhaClass.url,target:"_blank"}},[t._v("学习资料网页")]),0===t.buddhaClass.classSessions.length?n("div",{staticClass:"user-preview"},[t._v("\n    还没有开课，敬请期待！\n  ")]):n("div",{staticClass:"user-preview"},[n("h4",[t._v("正在闻思")]),t._l(t.buddhaClass.classSessions,(function(e,a){return n("ClassSession",{key:e.id+a,attrs:{classSession:e,attendance:t.buddhaClass.attendances[a]}})})),n("b-button",{attrs:{block:"",variant:"info",href:t.buddhaClass.url,target:"_blank"}},[t._v("查看上课记录")]),t.buddhaClass.practices.length>0?n("h4",[t._v("正在实修")]):t._e(),t._l(t.buddhaClass.practices,(function(t,e){return n("Practice",{key:t.id+e,attrs:{practice:t}})}))],2)],1)},u=[],l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-card",{staticClass:"text-center",attrs:{header:t.session.name}},[n("b-card-text",[n("b-input-group",{staticClass:"mt-3",attrs:{prepend:"上课时间："}},[n("b-form-input",{attrs:{readonly:""},model:{value:t.session.scheduledAtLocalDateTimeString,callback:function(e){t.$set(t.session,"scheduledAtLocalDateTimeString",e)},expression:"session.scheduledAtLocalDateTimeString"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"info",href:t.addToGoogleCalendarUrl(),target:"_blank"}},[n("b-icon",{attrs:{icon:"calendar-plus"}})],1)],1)],1),n("b-input-group",{staticClass:"mt-3",attrs:{prepend:"课前学习："}},[n("b-form-input",{attrs:{readonly:""},model:{value:t.session.materialState,callback:function(e){t.$set(t.session,"materialState",e)},expression:"session.materialState"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"info",href:t.session.url,target:"_blank"}},[n("b-icon",{attrs:{icon:"book"}})],1)],1)],1),n("b-input-group",{staticClass:"mt-3",attrs:{prepend:"上课出勤："}},[n("b-form-input",{attrs:{readonly:""},model:{value:t.session.attendanceState,callback:function(e){t.$set(t.session,"attendanceState",e)},expression:"session.attendanceState"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"warning"},on:{click:function(e){return t.updateAttendance()}}},[t._v(t._s(t.attendanceButtonName()))]),n("b-button",{attrs:{variant:"info"},on:{click:function(e){t.session.showDescription=!t.session.showDescription}}},[t.session.showDescription?n("b-icon",{attrs:{icon:"chevron-double-up"}}):n("b-icon",{attrs:{icon:"chevron-double-down"}})],1)],1)],1),t.session.showDescription?n("b-form-textarea",{attrs:{placeholder:"Auto height textarea",rows:"3","max-rows":"8"},model:{value:t.session.description,callback:function(e){t.$set(t.session,"description",e)},expression:"session.description"}}):t._e()],1)],1)],1)},d=[],p=(n("7f7f"),n("a481"),n("bf48")),h=n.n(p),b={name:"ClassSession",props:{classSession:{type:Object,required:!0},attendance:{type:Object,required:!0}},data:function(){return{session:{id:this.classSession.get("objectId"),name:this.classSession.get("name"),url:this.classSession.get("url"),description:this.classSession.get("description"),scheduledAtLocalDateTimeString:this.toLocalDateTimeString(this.classSession.get("scheduledAt")),showDescription:!1,attendanceState:this.toAttendanceStateString(this.attendance),materialState:this.toMaterialStateString(this.attendance)}}},methods:{toLocalDateTimeString:function(t){var e={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"};return t.toLocaleDateString("zh-CN",e)},toAttendanceStateString:function(t){if(t){if(t.qingJia)return"已请假";if(1==t.shangKe)return"已上课";if(0==t.shangKe&&void 0==t.qingJia)return"未上课"}return"未报考勤"},toMaterialStateString:function(t){var e="未看传承",n="未看法本";return t&&(t.chuanCheng&&(e="已看传承"),1==t.faBen&&(n="已看法本")),"".concat(e,"/").concat(n)},addToGoogleCalendarUrl:function(){var t=this.classSession.get("scheduledAt"),e=new Date;e.setTime(t.getTime()+144e5),t=t.toISOString().replace(/.000/g,"").replace(/:/g,"").replace(/-/g,""),e=e.toISOString().replace(/.000/g,"").replace(/:/g,"").replace(/-/g,"");var n="".concat(this.session.name,"&details=").concat(this.session.description);return n=encodeURI(n),"https://www.google.com/calendar/render?action=TEMPLATE&text=".concat(n,"&dates=").concat(t,"%2F").concat(e)},attendanceButtonName:function(){var t=new Date;return t<this.classSession.get("scheduledAt")?this.attendance.qingJia?"取消请假":"我要请假":void 0!=this.attendance.shangKe?"我要改考勤":"我要报考勤"},updateAttendance:function(){var t=this,e=new Date,n={},a="确认";if(e<this.classSession.get("scheduledAt")?this.attendance.qingJia?(n.qingJia=!1,a+="取消请假"):(n.qingJia=!0,n.shangKe=!1,a+="请假"):this.attendance.shangKe?(n.shangKe=!1,a+="没有上课"):(n.shangKe=!0,a+="上课"),1==confirm("".concat(a,"?"))){var r=this.classSession.get("url");h.a.Cloud.run("home:updateAttendance",{pathname:r,attendance:n}).then((function(e){console.log("updateAttendance - result: ".concat(JSON.stringify(e))),void 0!=e.qingJia&&(t.attendance.qingJia=e.qingJia),void 0!=e.shangKe&&(t.attendance.shangKe=e.shangKe),t.session.attendanceState=t.toAttendanceStateString(t.attendance)})).catch((function(t){console.log("error in updateAttendance: ".concat(t))}))}}}},f=b,g=n("2877"),v=Object(g["a"])(f,l,d,!1,null,null,null),m=v.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-card",{staticClass:"text-center",attrs:{header:t.practiceObj.name}},[n("b-card-text",[n("b-input-group",{staticClass:"mt-3",attrs:{prepend:"最新报数："}},[n("b-form-input",{attrs:{readonly:""},model:{value:t.practiceObj.practiceReportingState,callback:function(e){t.$set(t.practiceObj,"practiceReportingState",e)},expression:"practiceObj.practiceReportingState"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"info"},on:{click:function(e){t.practiceObj.showDescription=!t.practiceObj.showDescription}}},[t.practiceObj.showDescription?n("b-icon",{attrs:{icon:"chevron-double-up"}}):n("b-icon",{attrs:{icon:"chevron-double-down"}})],1)],1)],1),t.practiceObj.showDescription?n("b-form-textarea",{attrs:{placeholder:"Auto height textarea",rows:"3","max-rows":"8"},model:{value:t.practiceObj.description,callback:function(e){t.$set(t.practiceObj,"description",e)},expression:"practiceObj.description"}}):t._e(),n("b-button",{attrs:{block:"",variant:"warning"}},[t._v("我要报数")]),n("b-button",{attrs:{block:"",variant:"info",href:"",target:"_blank"}},[t._v("查看报数记录")])],1)],1)],1)},x=[],w={name:"Practice",props:{practice:{type:Object,required:!0}},data:function(){return{practiceObj:{id:this.practice.get("objectId"),name:this.practice.get("name"),description:this.practice.get("description"),showDescription:!1,practiceReportingState:"未报数"}}},methods:{toLocalDateTimeString:function(t){var e={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"};return t.toLocaleDateString("zh-CN",e)}}},O=w,y=Object(g["a"])(O,S,x,!1,null,null,null),j=y.exports,C={name:"Class",components:{ClassSession:m,Practice:j},props:{buddhaClass:{type:Object,required:!0}},data:function(){return{teachers:this.buddhaClass.teachers.join()}},methods:{createUser:function(){this.$router.push({name:"userCreate"})}}},_=C,D=Object(g["a"])(_,o,u,!1,null,null,null),k=D.exports,A={name:"StudentDashboard",props:{dashboard:{type:Object,required:!0}},components:{Class:k}},E=A,$=Object(g["a"])(E,i,c,!1,null,null,null),T=$.exports,q=n("2f62"),P=n("6c33"),R=n("4360");function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){Object(s["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var K={name:"Home",components:{StudentDashboard:T},beforeRouteEnter:function(t,e,n){console.log("from: ".concat(e.path)),e&&e.path&&e.path.startsWith("/home")?n():R["a"].dispatch(P["c"]).then((function(){n()}))},computed:L({},Object(q["b"])(["home","isLoadingDashboards"])),mounted:function(){}},I=K,M=Object(g["a"])(I,a,r,!1,null,null,null);e["default"]=M.exports},f559:function(t,e,n){"use strict";var a=n("5ca1"),r=n("9def"),s=n("d2c8"),i="startsWith",c=""[i];a(a.P+a.F*n("5147")(i),"String",{startsWith:function(t){var e=s(this,t,i),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),a=String(t);return c?c.call(e,a,n):e.slice(n,n+a.length)===a}})}}]);
//# sourceMappingURL=chunk-57e50852.94790e7c.js.map
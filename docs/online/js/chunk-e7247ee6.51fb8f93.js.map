{"version":3,"sources":["webpack:///./src/components/ClassSession.vue?89db","webpack:///src/components/ClassSession.vue","webpack:///./src/components/ClassSession.vue?c84f","webpack:///./src/components/ClassSession.vue","webpack:///./src/views/SessionManagement.vue?979e","webpack:///src/views/SessionManagement.vue","webpack:///./src/views/SessionManagement.vue?24eb","webpack:///./src/views/SessionManagement.vue","webpack:///./node_modules/core-js/modules/es6.regexp.replace.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","on","onSubmit","onReset","_v","_s","session","name","staticClass","attrs","readonly","model","value","callback","$$v","$set","expression","creating","_e","directives","rawName","$event","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","multiple","_l","newSession","key","id","domProps","newSessions","isClassAdmin","isTeachingAssistant","editSession","sessionDetails","submodules","length","url","submodule","index","forApplication","needToShowAttendanceButton","updateAttendance","attendanceButtonName","showDescription","staticRenderFns","props","classSession","classInfo","Boolean","forAdmin","data","dummy","sessionDropdownOptions","editing","computed","mounted","buildSessionDropdownOptions","methods","initSession","get","description","scheduledAt","scheduledAtLocalDateTimeString","toLocalDateTimeString","attendanceState","toAttendanceStateString","materialState","toMaterialStateString","currentSessionPushed","i","push","currentSession","s","year","month","day","hour","minute","date","toLocaleDateString","toLocalDateString","isStudent","attendance","onLeave","chuanCheng","faBen","studyRecord","lineage","textbook","addToGoogleCalendarUrl","eventStart","eventEnd","Date","setTime","getTime","encodeURI","d","undefined","msg","okText","cancelText","loader","title","body","$dialog","evt","preventDefault","console","log","oldId","dt","setHours","includes","component","filterSessions","filterText","composing","clearFilter","applyClass","createSession","creatingSession","classSessions","newClassSession","components","ClassSession","beforeRouteEnter","store","next","newAttendance","$store","dispatch","anObject","toObject","toLength","toInteger","advanceStringIndex","regExpExec","max","Math","min","floor","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","maybeToString","it","String","defined","REPLACE","$replace","maybeCallNative","searchValue","replaceValue","O","fn","regexp","res","done","rx","S","functionalReplace","global","fullUnicode","unicode","lastIndex","results","result","matchStr","accumulatedResult","nextSourcePosition","matched","position","captures","j","namedCaptures","groups","replacerArgs","concat","replacement","apply","getSubstitution","slice","str","tailPos","m","symbols","match","ch","capture","charAt","n","f"],"mappings":"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","file":"js/chunk-e7247ee6.51fb8f93.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.editing)?_c('b-form',{on:{\"submit\":_vm.onSubmit,\"reset\":_vm.onReset}},[_c('h4',[_vm._v(_vm._s(_vm.session.name ? _vm.session.name : \"创建新课\"))]),_c('b-input-group',{staticClass:\"mt-3\",attrs:{\"prepend\":\"选择日期：\"}},[_c('v-date-picker',{attrs:{\"locale\":\"zh-CN\",\"input-props\":{\n          readonly: true\n        }},model:{value:(_vm.session.scheduledAt),callback:function ($$v) {_vm.$set(_vm.session, \"scheduledAt\", $$v)},expression:\"session.scheduledAt\"}}),_c('b-input-group-append',[(!_vm.session.creating)?_c('b-button',{attrs:{\"type\":\"reset\",\"variant\":\"warning\"}},[_c('b-icon',{attrs:{\"icon\":\"x-circle\"}})],1):_vm._e(),_c('b-button',{attrs:{\"type\":\"submit\",\"variant\":\"success\"}},[_c('b-icon',{attrs:{\"icon\":\"check-circle\"}})],1)],1)],1),_c('b-input-group',{staticClass:\"mt-3\",attrs:{\"prepend\":\"选择课程：\"}},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.session.id),expression:\"session.id\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.session, \"id\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},_vm._l((_vm.sessionDropdownOptions),function(newSession){return _c('option',{key:newSession.id,domProps:{\"value\":newSession.id}},[_vm._v(\"\\n          \"+_vm._s(newSession.name)+\"\\n        \")])}),0),_c('b-input-group-append',[(!_vm.session.creating)?_c('b-button',{attrs:{\"type\":\"reset\",\"variant\":\"warning\"}},[_c('b-icon',{attrs:{\"icon\":\"x-circle\"}})],1):_vm._e()],1)],1),_c('b-form-textarea',{attrs:{\"placeholder\":\"输入上课通知\",\"rows\":\"8\",\"max-rows\":\"20\"},model:{value:(_vm.session.description),callback:function ($$v) {_vm.$set(_vm.session, \"description\", $$v)},expression:\"session.description\"}})],1):_c('b-card',{staticClass:\"text-center\",attrs:{\"header\":_vm.session.name}},[_c('b-card-text',[_c('b-input-group',{staticClass:\"mt-3\",attrs:{\"prepend\":\"上课时间：\"}},[_c('b-form-input',{attrs:{\"readonly\":\"\"},model:{value:(_vm.session.scheduledAtLocalDateTimeString),callback:function ($$v) {_vm.$set(_vm.session, \"scheduledAtLocalDateTimeString\", $$v)},expression:\"session.scheduledAtLocalDateTimeString\"}}),_c('b-input-group-append',[(_vm.newSessions && (_vm.isClassAdmin || _vm.isTeachingAssistant))?_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":_vm.editSession}},[_vm._v(\"修改\")]):_vm._e()],1)],1),(_vm.sessionDetails.submodules.length == 1)?_c('b-input-group',{staticClass:\"mt-3\",attrs:{\"prepend\":\"课前学习：\"}},[_c('b-form-input',{attrs:{\"readonly\":\"\"},model:{value:(_vm.session.materialState),callback:function ($$v) {_vm.$set(_vm.session, \"materialState\", $$v)},expression:\"session.materialState\"}}),_c('b-input-group-append',[_c('b-button',{attrs:{\"variant\":\"info\",\"href\":_vm.session.url,\"target\":\"_blank\"}},[_c('b-icon',{attrs:{\"icon\":\"book\"}})],1)],1)],1):_vm._l((_vm.sessionDetails.submodules),function(submodule,index){return _c('div',{key:submodule.id + index},[_c('b-link',{attrs:{\"href\":submodule.url,\"target\":\"_blank\"}},[_vm._v(_vm._s((\"(\" + (index + 1) + \") \" + (submodule.name))))]),_c('b-input-group',{staticClass:\"mt-3\",attrs:{\"prepend\":\"课前学习：\"}},[_c('b-form-input',{attrs:{\"readonly\":\"\"},model:{value:(_vm.session.materialState),callback:function ($$v) {_vm.$set(_vm.session, \"materialState\", $$v)},expression:\"session.materialState\"}}),_c('b-input-group-append',[_c('b-button',{attrs:{\"variant\":\"info\",\"href\":submodule.url,\"target\":\"_blank\"}},[_c('b-icon',{attrs:{\"icon\":\"book\"}})],1)],1)],1)],1)}),(!_vm.session.forApplication)?_c('b-input-group',{staticClass:\"mt-3\",attrs:{\"prepend\":\"上课出勤：\"}},[_c('b-form-input',{attrs:{\"readonly\":\"\"},model:{value:(_vm.session.attendanceState),callback:function ($$v) {_vm.$set(_vm.session, \"attendanceState\", $$v)},expression:\"session.attendanceState\"}}),_c('b-input-group-append',[(_vm.needToShowAttendanceButton())?_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":function($event){return _vm.updateAttendance()}}},[_vm._v(_vm._s(_vm.attendanceButtonName()))]):_vm._e(),_c('b-button',{attrs:{\"variant\":\"info\"},on:{\"click\":function($event){_vm.session.showDescription = !_vm.session.showDescription}}},[(_vm.session.showDescription)?_c('b-icon',{attrs:{\"icon\":\"chevron-double-up\"}}):_c('b-icon',{attrs:{\"icon\":\"chevron-double-down\"}})],1)],1)],1):_vm._e(),(_vm.session.showDescription)?_c('b-form-textarea',{attrs:{\"placeholder\":\"\",\"rows\":\"3\",\"max-rows\":\"8\",\"readonly\":\"\"},model:{value:(_vm.session.description),callback:function ($$v) {_vm.$set(_vm.session, \"description\", $$v)},expression:\"session.description\"}}):_vm._e()],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-form v-if=\"editing\" @submit=\"onSubmit\" @reset=\"onReset\">\n      <h4>{{ session.name ? session.name : \"创建新课\" }}</h4>\n      <b-input-group prepend=\"选择日期：\" class=\"mt-3\">\n        <v-date-picker\n          locale=\"zh-CN\"\n          v-model=\"session.scheduledAt\"\n          :input-props=\"{\n            readonly: true\n          }\"\n        />\n        <b-input-group-append>\n          <b-button v-if=\"!session.creating\" type=\"reset\" variant=\"warning\">\n            <b-icon icon=\"x-circle\"></b-icon>\n          </b-button>\n          <b-button type=\"submit\" variant=\"success\">\n            <b-icon icon=\"check-circle\"></b-icon>\n          </b-button>\n        </b-input-group-append>\n      </b-input-group>\n      <b-input-group prepend=\"选择课程：\" class=\"mt-3\">\n        <select v-model=\"session.id\">\n          <option\n            v-for=\"newSession in sessionDropdownOptions\"\n            v-bind:key=\"newSession.id\"\n            v-bind:value=\"newSession.id\"\n          >\n            {{ newSession.name }}\n          </option>\n        </select>\n        <b-input-group-append>\n          <b-button v-if=\"!session.creating\" type=\"reset\" variant=\"warning\">\n            <b-icon icon=\"x-circle\"></b-icon>\n          </b-button>\n        </b-input-group-append>\n      </b-input-group>\n      <b-form-textarea\n        v-model=\"session.description\"\n        placeholder=\"输入上课通知\"\n        rows=\"8\"\n        max-rows=\"20\"\n      ></b-form-textarea>\n    </b-form>\n    <b-card v-else class=\"text-center\" :header=\"session.name\">\n      <b-card-text>\n        <b-input-group prepend=\"上课时间：\" class=\"mt-3\">\n          <b-form-input\n            readonly\n            v-model=\"session.scheduledAtLocalDateTimeString\"\n          ></b-form-input>\n          <b-input-group-append>\n            <b-button\n              variant=\"warning\"\n              v-if=\"newSessions && (isClassAdmin || isTeachingAssistant)\"\n              v-on:click=\"editSession\"\n              >修改</b-button\n            >\n            <!--\n            <b-button\n              variant=\"info\"\n              :href=\"addToGoogleCalendarUrl()\"\n              target=\"_blank\"\n            >\n              <b-icon icon=\"calendar-plus\"></b-icon>\n            </b-button>\n            -->\n          </b-input-group-append>\n        </b-input-group>\n        <b-input-group\n          v-if=\"sessionDetails.submodules.length == 1\"\n          prepend=\"课前学习：\"\n          class=\"mt-3\"\n        >\n          <b-form-input readonly v-model=\"session.materialState\"></b-form-input>\n          <b-input-group-append>\n            <b-button variant=\"info\" :href=\"session.url\" target=\"_blank\">\n              <b-icon icon=\"book\"></b-icon>\n            </b-button>\n          </b-input-group-append>\n        </b-input-group>\n        <div\n          v-else\n          v-for=\"(submodule, index) in sessionDetails.submodules\"\n          :key=\"submodule.id + index\"\n        >\n          <b-link :href=\"submodule.url\" target=\"_blank\">{{\n            `(${index + 1}) ${submodule.name}`\n          }}</b-link>\n          <b-input-group prepend=\"课前学习：\" class=\"mt-3\">\n            <b-form-input\n              readonly\n              v-model=\"session.materialState\"\n            ></b-form-input>\n            <b-input-group-append>\n              <b-button variant=\"info\" :href=\"submodule.url\" target=\"_blank\">\n                <b-icon icon=\"book\"></b-icon>\n              </b-button>\n            </b-input-group-append>\n          </b-input-group>\n        </div>\n        <b-input-group\n          v-if=\"!session.forApplication\"\n          prepend=\"上课出勤：\"\n          class=\"mt-3\"\n        >\n          <b-form-input\n            readonly\n            v-model=\"session.attendanceState\"\n          ></b-form-input>\n          <b-input-group-append>\n            <b-button\n              variant=\"warning\"\n              v-if=\"needToShowAttendanceButton()\"\n              v-on:click=\"updateAttendance()\"\n              >{{ attendanceButtonName() }}</b-button\n            >\n            <b-button\n              variant=\"info\"\n              v-on:click=\"session.showDescription = !session.showDescription\"\n            >\n              <b-icon\n                v-if=\"session.showDescription\"\n                icon=\"chevron-double-up\"\n              ></b-icon>\n              <b-icon v-else icon=\"chevron-double-down\"></b-icon>\n            </b-button>\n          </b-input-group-append>\n        </b-input-group>\n        <b-form-textarea\n          v-if=\"session.showDescription\"\n          v-model=\"session.description\"\n          placeholder=\"\"\n          rows=\"3\"\n          max-rows=\"8\"\n          readonly\n        ></b-form-textarea>\n      </b-card-text>\n    </b-card>\n  </div>\n</template>\n\n<script>\nimport Parse from \"parse\";\nimport { mapGetters } from \"vuex\";\nimport { parseSessionIndex } from \"../store/buddhaclass.module\";\n\nexport default {\n  name: \"ClassSession\",\n  props: {\n    classSession: { type: Object, required: true },\n    sessionDetails: { type: Object, required: false },\n    classInfo: { type: Object, required: false },\n    newSessions: { type: Array, required: false },\n    forApplication: Boolean,\n    forAdmin: Boolean\n  },\n  data: function() {\n    return {\n      session: this.classSession.dummy\n        ? { creating: true, editing: true }\n        : this.initSession(),\n      sessionDropdownOptions: [],\n      editing: this.classSession.dummy\n    };\n  },\n  computed: {\n    ...mapGetters([\"isClassAdmin\", \"isTeachingAssistant\", \"isStudent\"])\n  },\n  mounted() {\n    this.buildSessionDropdownOptions();\n  },\n  methods: {\n    initSession() {\n      return {\n        id: this.classSession.id,\n        forApplication: this.classInfo\n          ? this.classInfo.forApplication\n          : this.forApplication,\n        name: this.classSession.get(\"name\"),\n        url: this.sessionDetails.submodules[0].url,\n        description: this.classSession.get(\"description\"),\n        scheduledAt: this.classSession.get(\"scheduledAt\"),\n        scheduledAtLocalDateTimeString: this.toLocalDateTimeString(\n          this.classSession.get(\"scheduledAt\")\n        ),\n        showDescription: false,\n        attendanceState: this.toAttendanceStateString(this.sessionDetails),\n        materialState: this.toMaterialStateString(this.sessionDetails, 0)\n      };\n    },\n    buildSessionDropdownOptions() {\n      this.sessionDropdownOptions = [];\n      if (!this.editing) {\n        return;\n      }\n      if (this.classSession.dummy) {\n        this.sessionDropdownOptions = this.newSessions;\n      } else {\n        const currentSession = {\n          id: this.classSession.id,\n          name: this.classSession.get(\"name\")\n        };\n        const order = parseSessionIndex(currentSession.name);\n        var currentSessionPushed = false;\n        for (var i = 0; i < this.newSessions.length; i++) {\n          const s = this.newSessions[i];\n          if (!currentSessionPushed && parseSessionIndex(s.name) > order) {\n            this.sessionDropdownOptions.push(currentSession);\n            currentSessionPushed = true;\n          }\n          this.sessionDropdownOptions.push(s);\n        }\n      }\n    },\n    toLocalDateTimeString(date) {\n      const options = {\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\",\n        hour: \"numeric\",\n        minute: \"numeric\"\n      };\n      return date.toLocaleDateString(\"zh-CN\", options);\n    },\n    toLocalDateString(date) {\n      const options = {\n        year: \"numeric\",\n        month: \"short\",\n        day: \"numeric\"\n      };\n      return date.toLocaleDateString(\"zh-CN\", options);\n    },\n    needToShowAttendanceButton() {\n      // console.log(\n      //   `needToShowAttendanceButton - this.isStudent: ${this.isStudent} this.forAdmin: ${this.forAdmin} this.forApplication: ${this.forApplication}`\n      // );\n      return this.isStudent && !this.forAdmin && !this.forApplication;\n      // const scheduledAt = this.classSession.get(\"scheduledAt\");\n      // if (this.isStudent) {\n      //   const today = new Date();\n      //   //student must submit sessionDetails within 3 days\n      //   var cutoffTime = new Date(\n      //     scheduledAt.getTime() + 4 * 24 * 60 * 60 * 1000\n      //   );\n      //   cutoffTime.setHours(0, 0, 0, 0); //set to midnight\n      //   // console.log(`needToShowAttendanceButton - cutoffTime: ${cutoffTime}`);\n      //   return today.getTime() < cutoffTime.getTime();\n      // }\n      // return false;\n    },\n    toAttendanceStateString(sessionDetails) {\n      if (sessionDetails) {\n        if (typeof sessionDetails.attendance.attendance == \"number\") {\n          return `${sessionDetails.attendance.attendance}人已上课`;\n        }\n        if (sessionDetails.attendance.onLeave) {\n          return \"已请假\";\n        }\n        if (sessionDetails.attendance.attendance == true) {\n          return \"已上课\";\n        }\n        if (\n          sessionDetails.attendance.attendance == false &&\n          sessionDetails.attendance.onLeave == undefined\n        ) {\n          return \"未上课\";\n        }\n      }\n\n      return \"未报考勤\";\n    },\n    toMaterialStateString(sessionDetails, index) {\n      if (this.forApplication) {\n        return \"请在课前看完传承/法本\";\n      }\n      var chuanCheng = \"未看传承\";\n      var faBen = \"未看法本\";\n      if (sessionDetails && sessionDetails.submodules[index].studyRecord) {\n        const studyRecord = sessionDetails.submodules[index].studyRecord;\n        if (typeof studyRecord.lineage == \"number\") {\n          chuanCheng = `${studyRecord.lineage}人已看传承`;\n        } else if (studyRecord.lineage) {\n          chuanCheng = \"已看传承\";\n        }\n        if (typeof studyRecord.textbook == \"number\") {\n          faBen = `${studyRecord.textbook}人已看法本`;\n        } else if (studyRecord.textbook) {\n          faBen = \"已看法本\";\n        }\n      }\n\n      return `${chuanCheng}/${faBen}`;\n    },\n    addToGoogleCalendarUrl() {\n      var eventStart = this.session.scheduledAt;\n      var eventEnd = new Date();\n      eventEnd.setTime(eventStart.getTime() + 4 * 60 * 60 * 1000);\n      eventStart = eventStart\n        .toISOString()\n        .replace(/.000/g, \"\")\n        .replace(/:/g, \"\")\n        .replace(/-/g, \"\");\n      eventEnd = eventEnd\n        .toISOString()\n        .replace(/.000/g, \"\")\n        .replace(/:/g, \"\")\n        .replace(/-/g, \"\");\n      var url = `${this.session.name}&details=${this.session.description}`;\n      url = encodeURI(url);\n      return `https://www.google.com/calendar/render?action=TEMPLATE&text=${url}&dates=${eventStart}%2F${eventEnd}`;\n    },\n    attendanceButtonName() {\n      const d = new Date();\n      if (d < this.classSession.get(\"scheduledAt\")) {\n        if (this.sessionDetails.attendance.onLeave) {\n          return \"取消请假\";\n        }\n        return \"我要请假\";\n      } else {\n        if (this.sessionDetails.attendance.attendance != undefined) {\n          return \"我要改考勤\";\n        }\n        return \"我要报考勤\";\n      }\n    },\n    updateAttendance() {\n      const d = new Date();\n      var msg = \"确认\";\n      var attendance = this.sessionDetails.attendance;\n      if (d < this.classSession.get(\"scheduledAt\")) {\n        if (attendance.onLeave) {\n          attendance.onLeave = false;\n          msg += \"取消请假\";\n        } else {\n          attendance.onLeave = true;\n          attendance.attendance = false;\n          msg += \"请假\";\n        }\n      } else {\n        if (attendance.attendance) {\n          attendance.attendance = false;\n          msg += \"没有上课\";\n        } else {\n          attendance.attendance = true;\n          msg += \"已上课\";\n        }\n      }\n\n      const sessionId = this.classSession.id;\n      const options = {\n        okText: \"确认\",\n        cancelText: \"取消\",\n        loader: true // default: false - when set to true, the proceed button shows a loader when clicked; and a dialog object will be passed to the then() callback\n      };\n      const message = {\n        title: this.session.name,\n        body: msg + \"?\"\n      };\n      const thisComponent = this;\n\n      this.$dialog\n        .confirm(message, options)\n        .then(function(dialog) {\n          Parse.Cloud.run(\"home:updateAttendanceV2\", { sessionId, attendance })\n            .then(result => {\n              console.log(\n                `updateAttendanceV2 - result: ${JSON.stringify(result)}`\n              );\n              if (result.attendance.onLeave != undefined) {\n                thisComponent.sessionDetails.attendance.onLeave =\n                  result.attendance.onLeave;\n              }\n              if (result.attendance.attendance != undefined) {\n                thisComponent.sessionDetails.attendance.attendance =\n                  result.attendance.attendance;\n              }\n              thisComponent.session.attendanceState = thisComponent.toAttendanceStateString(\n                thisComponent.sessionDetails\n              );\n              dialog.close();\n            })\n            .catch(e => {\n              console.log(`error in updateAttendanceV2: ${e}`);\n              dialog.close();\n              thisComponent.$dialog.alert(`error in updateAttendance: ${e}`);\n            });\n        })\n        .catch(e => {\n          console.log(`error: ${e}`);\n        });\n    },\n    editSession() {\n      this.session = this.initSession();\n      this.editing = true;\n      this.buildSessionDropdownOptions();\n    },\n    onReset(evt) {\n      evt.preventDefault();\n      this.editing = false;\n    },\n    onSubmit(evt) {\n      evt.preventDefault();\n      const sessionId = this.session.id;\n      console.log(`sessionId: ${sessionId}`);\n\n      const classSession = this.classInfo.classSessions.filter(\n        e => e.id === sessionId\n      )[0];\n\n      const options = {\n        okText: \"确认\",\n        cancelText: \"取消\",\n        loader: true // default: false - when set to true, the proceed button shows a loader when clicked; and a dialog object will be passed to the then() callback\n      };\n      const message = {\n        title: this.classInfo.name,\n        body: `${\n          this.session.creating ? \"创建新课\" : \"修改\"\n        } 《${classSession.get(\"name\")}》 @ ${this.toLocalDateString(\n          this.session.scheduledAt\n        )}？`\n      };\n\n      const session = this.session;\n      session.oldId = this.classSession.id;\n      var dt = new Date(session.scheduledAt);\n      dt.setHours(classSession.get(\"url\").includes(\"rpsxl\") ? 9 : 14); //TODO: allow setting time\n      session.scheduledAt = dt;\n      // console.log(`session.scheduledAt: ${session.scheduledAt}`);\n\n      const thisComponent = this;\n\n      this.$dialog\n        .confirm(message, options)\n        .then(function(dialog) {\n          Parse.Cloud.run(\"class:updateClassSession\", { session })\n            .then(result => {\n              console.log(\n                `updateClassSession - result: ${JSON.stringify(result)}`\n              );\n              dialog.close();\n              // thisComponent.$router.go();\n              window.location.reload();\n            })\n            .catch(e => {\n              console.log(`error in updateClassSession: ${JSON.stringify(e)}`);\n              dialog.close();\n              thisComponent.$dialog.alert(`error in updateClassSession: ${e}`);\n            });\n        })\n        .catch(e => {\n          console.log(`error: ${e}`);\n        });\n    }\n  }\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassSession.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassSession.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ClassSession.vue?vue&type=template&id=c9b59692&\"\nimport script from \"./ClassSession.vue?vue&type=script&lang=js&\"\nexport * from \"./ClassSession.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.isLoadingSessions)?_c('div',[_vm._v(\"\\n    正在获取课程详情...\\n  \")]):_c('div',[_c('h3',{domProps:{\"textContent\":_vm._s(_vm.classInfo.name)}}),_c('div',{staticClass:\"input-group mb-3\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.filterText),expression:\"filterText\"}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"aria-describedby\":\"basic-addon2\",\"placeholder\":\"搜索\"},domProps:{\"value\":(_vm.filterText)},on:{\"change\":function($event){return _vm.filterSessions(_vm.filterText)},\"input\":function($event){if($event.target.composing){ return; }_vm.filterText=$event.target.value}}}),_c('div',{staticClass:\"input-group-append\"},[_c('button',{staticClass:\"btn btn-outline-secondary\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.clearFilter}},[_vm._v(\"\\n          清除\\n        \")]),(_vm.classInfo.forApplication)?_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":function($event){return _vm.applyClass()}}},[_vm._v(\"我要报名\")]):_vm._e(),(_vm.isClassAdmin || _vm.isTeachingAssistant)?_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":_vm.createSession}},[_vm._v(_vm._s(_vm.creatingSession ? \"取消创建\" : \"创建新课\"))]):_vm._e()],1)]),(_vm.classSessions.length === 0)?_c('div',[_vm._v(\"\\n      没有找到上课记录！\\n    \")]):_vm._e(),(_vm.creatingSession)?_c('ClassSession',{attrs:{\"classInfo\":_vm.classInfo,\"classSession\":_vm.newClassSession}}):_vm._e(),_vm._l((_vm.classSessions),function(classSession,index){return _c('ClassSession',{key:classSession.id + index,attrs:{\"classInfo\":_vm.classInfo,\"forApplication\":_vm.classInfo.forApplication,\"forAdmin\":_vm.classInfo.forAdmin,\"classSession\":classSession,\"sessionDetails\":_vm.sessionDetails[index]}})})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div v-if=\"isLoadingSessions\">\n      正在获取课程详情...\n    </div>\n    <div v-else>\n      <h3 v-text=\"classInfo.name\" />\n      <div class=\"input-group mb-3\">\n        <input\n          type=\"text\"\n          class=\"form-control\"\n          aria-describedby=\"basic-addon2\"\n          v-model=\"filterText\"\n          v-on:change=\"filterSessions(filterText)\"\n          placeholder=\"搜索\"\n        />\n        <div class=\"input-group-append\">\n          <button\n            class=\"btn btn-outline-secondary\"\n            type=\"button\"\n            @click=\"clearFilter\"\n          >\n            清除\n          </button>\n          <b-button\n            variant=\"warning\"\n            v-if=\"classInfo.forApplication\"\n            v-on:click=\"applyClass()\"\n            >我要报名</b-button\n          >\n          <b-button\n            variant=\"warning\"\n            v-if=\"isClassAdmin || isTeachingAssistant\"\n            @click=\"createSession\"\n            >{{ creatingSession ? \"取消创建\" : \"创建新课\" }}</b-button\n          >\n        </div>\n      </div>\n      <div v-if=\"classSessions.length === 0\">\n        没有找到上课记录！\n      </div>\n      <ClassSession\n        v-if=\"creatingSession\"\n        :classInfo=\"classInfo\"\n        :classSession=\"newClassSession\"\n      />\n      <ClassSession\n        v-for=\"(classSession, index) in classSessions\"\n        :classInfo=\"classInfo\"\n        :forApplication=\"classInfo.forApplication\"\n        :forAdmin=\"classInfo.forAdmin\"\n        :classSession=\"classSession\"\n        :sessionDetails=\"sessionDetails[index]\"\n        :key=\"classSession.id + index\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from \"vuex\";\nimport ClassSession from \"@/components/ClassSession\";\nimport { FETCH_SESSIONS, FILTER_SESSIONS } from \"../store/actions.type\";\nimport store from \"@/store\";\nimport Parse from \"parse\";\n\nexport default {\n  name: \"SessionManagement\",\n  components: {\n    ClassSession\n  },\n  computed: {\n    ...mapGetters([\n      \"isLoadingSessions\",\n      \"classInfo\",\n      \"classSessions\",\n      \"sessionDetails\",\n      \"isClassAdmin\",\n      \"isTeachingAssistant\",\n      \"isStudent\"\n    ])\n  },\n  beforeRouteEnter(to, from, next) {\n    store.dispatch(FETCH_SESSIONS, to.params).then(() => {\n      next();\n    });\n  },\n  data: function() {\n    return {\n      filterText: \"\",\n      creatingSession: false,\n      newClassSession: { dummy: true },\n      newAttendance: { dummy: true }\n    };\n  },\n  methods: {\n    filterSessions(filterText) {\n      this.$store.dispatch(FILTER_SESSIONS, filterText);\n    },\n    clearFilter() {\n      this.filterText = \"\";\n      this.$store.dispatch(FILTER_SESSIONS, this.filterText);\n    },\n    createSession() {\n      this.creatingSession = !this.creatingSession;\n    },\n    applyClass() {\n      const classId = this.classInfo.id;\n      const options = {\n        okText: \"确认\",\n        cancelText: \"取消\"\n      };\n      const message = {\n        title: this.classInfo.name,\n        body: `顶礼上师三宝！真的要报名？`\n      };\n      const thisComponent = this;\n\n      console.log(`applyClass - classId: ${classId}`);\n\n      this.$dialog\n        .confirm(message, options)\n        .then(function() {\n          Parse.Cloud.run(\"class:apply\", {\n            classId\n          })\n            .then(result => {\n              console.log(`class:apply - result: ${JSON.stringify(result)}`);\n\n              thisComponent.$router.push({ name: \"home\" });\n            })\n            .catch(e => {\n              console.log(`error in class:apply: ${e}`);\n            });\n        })\n        .catch(e => {\n          console.log(`error: ${e}`);\n        });\n    }\n  }\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SessionManagement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SessionManagement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SessionManagement.vue?vue&type=template&id=6bfcd6f8&\"\nimport script from \"./SessionManagement.vue?vue&type=script&lang=js&\"\nexport * from \"./SessionManagement.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\n\nvar anObject = require('./_an-object');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar toInteger = require('./_to-integer');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&`']|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&`']|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nrequire('./_fix-re-wks')('replace', 2, function (defined, REPLACE, $replace, maybeCallNative) {\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = defined(this);\n      var fn = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return fn !== undefined\n        ? fn.call(searchValue, O, replaceValue)\n        : $replace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      var res = maybeCallNative($replace, regexp, this, replaceValue);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n        results.push(result);\n        if (!global) break;\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n\n    // https://tc39.github.io/ecma262/#sec-getsubstitution\n  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n    var tailPos = position + matched.length;\n    var m = captures.length;\n    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n    if (namedCaptures !== undefined) {\n      namedCaptures = toObject(namedCaptures);\n      symbols = SUBSTITUTION_SYMBOLS;\n    }\n    return $replace.call(replacement, symbols, function (match, ch) {\n      var capture;\n      switch (ch.charAt(0)) {\n        case '$': return '$';\n        case '&': return matched;\n        case '`': return str.slice(0, position);\n        case \"'\": return str.slice(tailPos);\n        case '<':\n          capture = namedCaptures[ch.slice(1, -1)];\n          break;\n        default: // \\d\\d?\n          var n = +ch;\n          if (n === 0) return match;\n          if (n > m) {\n            var f = floor(n / 10);\n            if (f === 0) return match;\n            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n            return match;\n          }\n          capture = captures[n - 1];\n      }\n      return capture === undefined ? '' : capture;\n    });\n  }\n});\n"],"sourceRoot":""}